# Ethereum Contracts

This directory contains smart contracts utilized by the Polkadot-Ethereum Bridge.

## Development

Make sure you use a recent node version, e. g. with [nvm](https://github.com/nvm-sh/nvm#installing-and-updating):

```bash
nvm install 14.16.1
nvm use 14.16.1
```

Install dependencies with yarn:

```bash
yarn install
```

Create an `.env` file using the `env.template` as a template. Note that deploying to ropsten network requires setting the INFURA_PROJECT_ID and ROPSTEN_PRIVATE_KEY environment variables.

Example:

```bash
cp env.template .env
```

## Testing

Run tests on the hardhat network:

```bash
yarn test
```

## Deployment

### Local

Example: Run a local hardhat instance with deployments

```
yarn hardhat node
```

### Ropsten, Mainnet

```
yarn hardhat deploy --network ropsten
```

## Upgrade apps

Example: upgrade an app to use a different set of channels

```sh
# Do something first to deploy new channels
yarn hardhat upgrade \
  --appaddr       0x959922bE3CAee4b8Cd9a407cc3ac1C251C2007B1 \
  --basicinbound  0x0000000000000000000000000000000000000001 \
  --basicoutbound 0x0000000000000000000000000000000000000002 \
  --incinbound    0x0000000000000000000000000000000000000003 \
  --incoutbound   0x0000000000000000000000000000000000000004 \
  --network       localhost # change to ropsten or mainnet accordingly
```

## Autogenerated Documentation

Solidity documentation can be autogenerated using the [solidity-docgen](https://github.com/OpenZeppelin/solidity-docgen) library. It will generate markdown files from the contracts directory and output them to the docs directory.

```bash
# The library is only compatible with npx
npx solidity-docgen
```
